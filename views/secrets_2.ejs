<%
var knn_bin_cls = typeof knn_bin_cls !== 'undefined' ? knn_bin_cls : 'Attack';
var knn_mul_cls = typeof knn_mul_cls !== 'undefined' ? knn_mul_cls : 'DoS';
var knn_desc = typeof knn_desc !== 'undefined' ? knn_desc : 'A Denial-of-Service (DoS) attack...';
var knn_bin_acc = typeof knn_bin_acc !== 'undefined' ? knn_bin_acc : '0.98';
var knn_mul_acc = typeof knn_mul_acc !== 'undefined' ? knn_mul_acc : '0.97';
var rf_bin_cls = typeof rf_bin_cls !== 'undefined' ? rf_bin_cls : 'Normal';
var rf_mul_cls = typeof rf_mul_cls !== 'undefined' ? rf_mul_cls : 'Normal';
var rf_desc = typeof rf_desc !== 'undefined' ? rf_desc : 'This is safe.';
var rf_bin_acc = typeof rf_bin_acc !== 'undefined' ? rf_bin_acc : '0.99';
var rf_mul_acc = typeof rf_mul_acc !== 'undefined' ? rf_mul_acc : '0.98';
var cnn_bin_cls = typeof cnn_bin_cls !== 'undefined' ? cnn_bin_cls : 'Attack';
var cnn_mul_cls = typeof cnn_mul_cls !== 'undefined' ? cnn_mul_cls : 'Probe';
var cnn_desc = typeof cnn_desc !== 'undefined' ? cnn_desc : 'Probing is another type of attack...';
var cnn_bin_acc = typeof cnn_bin_acc !== 'undefined' ? cnn_bin_acc : '0.95';
var cnn_mul_acc = typeof cnn_mul_acc !== 'undefined' ? cnn_mul_acc : '0.94';
var lstm_bin_cls = typeof lstm_bin_cls !== 'undefined' ? lstm_bin_cls : 'Normal';
var lstm_mul_cls = typeof lstm_mul_cls !== 'undefined' ? lstm_mul_cls : 'Normal';
var lstm_desc = typeof lstm_desc !== 'undefined' ? lstm_desc : 'This is safe.';
var lstm_bin_acc = typeof lstm_bin_acc !== 'undefined' ? lstm_bin_acc : '0.96';
var lstm_mul_acc = typeof lstm_mul_acc !== 'undefined' ? lstm_mul_acc : '0.95';
// Algorithm-specific attack counts
var knn_attack_counts = typeof knn_attack_counts !== 'undefined' ? knn_attack_counts : { DoS: 123, Probe: 45, R2L: 12, U2R: 3 };
var rf_attack_counts = typeof rf_attack_counts !== 'undefined' ? rf_attack_counts : { DoS: 100, Probe: 30, R2L: 10, U2R: 2 };
var cnn_attack_counts = typeof cnn_attack_counts !== 'undefined' ? cnn_attack_counts : { DoS: 80, Probe: 60, R2L: 5, U2R: 1 };
var lstm_attack_counts = typeof lstm_attack_counts !== 'undefined' ? lstm_attack_counts : { DoS: 90, Probe: 20, R2L: 8, U2R: 0 };
%>
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>NIDS - Results</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Montserrat:700,400|Ubuntu"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      crossorigin="anonymous"
    />

    <style>
      :root {
        --primary: #00adb5;
        --accent: #393e46;
        --muted: #eeeeee;
      }

      body {
        font-family: "Montserrat", "Ubuntu", sans-serif;
        background: var(--muted);
        color: var(--accent);
        margin: 0;
        padding: 0;
      }

      /* NAVBAR */
      .navbar {
        background: linear-gradient(
          90deg,
          #393e46 70%,
          #00adb5 100%
        ) !important;
        box-shadow: 0 2px 16px rgba(57, 62, 70, 0.08);
        padding: 1rem 2rem;
      }
      .navbar-brand {
        font-weight: bold;
        letter-spacing: 2px;
        font-size: 1.7rem;
        color: #fff !important;
      }
      .navbar-nav .nav-link {
        color: #eee !important;
        margin-right: 1.2rem;
        transition: color 0.2s;
        font-weight: 500;
      }
      .navbar-nav .nav-link.active,
      .navbar-nav .nav-link:hover {
        color: var(--primary) !important;
      }

      /* RESULTS CARDS */
      .card-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 0.5rem;
      }
      .card {
        background: #f7fafb;
        border-radius: 18px;
        box-shadow: 0 3px 18px -8px #aad7da4a;
        border: none;
        transition: transform 0.17s, box-shadow 0.18s;
        min-height: 390px;
        margin-bottom: 24px;
      }
      .card:hover {
        transform: translateY(-2px) scale(1.025);
        box-shadow: 0 14px 44px -8px #00adb540;
      }
      .card-text.feature-desc {
        color: #425058;
        font-size: 1.08rem;
        margin-bottom: 0.5rem;
      }
      .card-text span {
        color: var(--accent);
        font-weight: 550;
      }
      .btn-primary,
      .btn-primary:active,
      .btn-primary:focus {
        background: var(--primary) !important;
        border: none;
        color: #fff;
        box-shadow: 0 2px 12px #00adb527;
        transition: box-shadow 0.14s, background 0.22s;
      }
      .btn-primary:hover {
        background: #199fa7 !important;
        color: #fff;
      }
      .btn-outline-primary {
        border-color: var(--primary);
        color: var(--primary);
      }
      .btn-outline-primary:hover {
        background: var(--primary);
        color: #fff;
      }
      .btn-danger {
        background: #dd4b39 !important;
        border: none;
      }
      .btn-danger:hover {
        background: #b43724 !important;
      }
      .btn-block {
        width: 100%;
        margin-bottom: 0.5rem;
      }

      /* LAYOUT */
      .results-section {
        padding-top: 44px;
        padding-bottom: 36px;
      }
      .results-section .row {
        margin-bottom: 18px;
      }

      @media (max-width: 991px) {
        .card {
          min-height: initial;
        }
      }
      @media (max-width: 767px) {
        .navbar {
          padding: 10px 1rem;
        }
        .results-section {
          padding-top: 22px;
          padding-bottom: 18px;
        }
      }

      /* Attack counts list */
      .attack-counts {
        max-height: 100px;
        overflow-y: auto;
        padding: 5px;
        margin-bottom: 10px;
        border: 1px solid #eee;
        border-radius: 5px;
        font-size: 0.9rem;
      }
      .attack-counts li {
        display: flex;
        justify-content: space-between;
      }
      .attack-counts b {
        color: #00adb5;
      }
    </style>
  </head>
  <body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
      <a
        class="navbar-brand"
        href="#"
        style="display: flex; align-items: center"
      >
        <i
          class="fas fa-shield-alt mr-2"
          style="font-size: 1.5rem; color: #31e6d4"
        ></i
        >NIDS
      </a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarTogglerDemo02"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
          <li class="nav-item">
            <a class="nav-link" href="/submit">Predict</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/features">Features</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/attacks">Attacks</a>
          </li>
          <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
          <li class="nav-item"><a class="nav-link" href="/stats">Stats</a></li>
          <li class="nav-item">
            <a class="nav-link" href="/logout">Logout</a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- RESULTS SECTION -->
    <section class="results-section">
      <div class="container">
        <div class="row justify-content-center">
          <!-- KNN -->
          <div class="col-md-6 col-lg-6 col-xl-3">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center">
                <h4 class="card-title">
                  <i class="fas fa-users mr-1"></i> K-Nearest-Neighbor (KNN)
                </h4>
                <p class="card-text feature-desc"><%= knn_bin_cls %></p>
                <p class="card-text feature-desc"><%= knn_mul_cls %></p>
                <p class="card-text feature-desc"><%= knn_desc %></p>
                <p class="card-text">
                  <span>Binary Acc.:</span> <%= knn_bin_acc %>
                </p>
                <p class="card-text">
                  <span>Multi Acc.:</span> <%= knn_mul_acc %>
                </p>
                <h5>Attack Type Counts:</h5>
                <ul class="attack-counts">
                  <% if (knn_attack_counts &&
                  Object.keys(knn_attack_counts).length > 0) { %> <%
                  Object.keys(knn_attack_counts).forEach(function(type){ %>
                  <li><b><%= type %>:</b> <%= knn_attack_counts[type] %></li>
                  <% }); %> <% } else { %>
                  <li>DoS: 320</li>
                  <li>Probe: 150</li>
                  <li>Normal: 500</li>
                  <% } %>
                </ul>
                <a class="btn btn-primary btn-block" href="/knn_bin_table"
                  >Binary-Class Table</a
                >
                <a class="btn btn-outline-primary btn-block" href="/knn_table"
                  >Multi-Class Table</a
                >
              </div>
            </div>
          </div>
          <!-- RF -->
          <div class="col-md-6 col-lg-6 col-xl-3">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center">
                <h4 class="card-title">
                  <i class="fas fa-tree mr-1"></i> Random Forest Decision Tree
                </h4>
                <p class="card-text feature-desc"><%= rf_bin_cls %></p>
                <p class="card-text feature-desc"><%= rf_mul_cls %></p>
                <p class="card-text feature-desc"><%= rf_desc %></p>
                <p class="card-text">
                  <span>Binary Acc.:</span> <%= rf_bin_acc %>
                </p>
                <p class="card-text">
                  <span>Multi Acc.:</span> <%= rf_mul_acc %>
                </p>
                <h5>Attack Type Counts:</h5>
                <ul class="attack-counts">
                  <% if (rf_attack_counts &&
                  Object.keys(rf_attack_counts).length > 0) { %> <%
                  Object.keys(rf_attack_counts).forEach(function(type){ %>
                  <li><b><%= type %>:</b> <%= rf_attack_counts[type] %></li>
                  <% }); %> <% } else { %>
                  <li></li>
                  <% } %>
                </ul>
                <a class="btn btn-primary btn-block" href="/rf_bin_table"
                  >Binary-Class Table</a
                >
                <a class="btn btn-outline-primary btn-block" href="/rf_table"
                  >Multi-Class Table</a
                >
              </div>
            </div>
          </div>
          <!-- CNN -->
          <div class="col-md-6 col-lg-6 col-xl-3">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center">
                <h4 class="card-title">
                  <i class="fas fa-brain mr-1"></i> Convolutional Neural Net
                  (CNN)
                </h4>
                <p class="card-text feature-desc"><%= cnn_bin_cls %></p>
                <p class="card-text feature-desc"><%= cnn_mul_cls %></p>
                <p class="card-text feature-desc"><%= cnn_desc %></p>
                <p class="card-text">
                  <span>Binary Acc.:</span> <%= cnn_bin_acc %>
                </p>
                <p class="card-text">
                  <span>Multi Acc.:</span> <%= cnn_mul_acc %>
                </p>
                <h5>Attack Type Counts:</h5>
                <ul class="attack-counts">
                  <% if (cnn_attack_counts &&
                  Object.keys(cnn_attack_counts).length > 0) { %> <%
                  Object.keys(cnn_attack_counts).forEach(function(type){ %>
                  <li><b><%= type %>:</b> <%= cnn_attack_counts[type] %></li>
                  <% }); %> <% } else { %>
                  <li></li>
                  <% } %>
                </ul>
                <a class="btn btn-primary btn-block" href="/cnn_bin_table"
                  >Binary-Class Table</a
                >
                <a class="btn btn-outline-primary btn-block" href="/cnn_table"
                  >Multi-Class Table</a
                >
              </div>
            </div>
          </div>
          <!-- LSTM -->
          <div class="col-md-6 col-lg-6 col-xl-3">
            <div class="card shadow-sm h-100">
              <div class="card-body text-center">
                <h4 class="card-title">
                  <i class="fas fa-wave-square mr-1"></i> Long Short Term Memory
                  (LSTM)
                </h4>
                <p class="card-text feature-desc"><%= lstm_bin_cls %></p>
                <p class="card-text feature-desc"><%= lstm_mul_cls %></p>
                <p class="card-text feature-desc"><%= lstm_desc %></p>
                <p class="card-text">
                  <span>Binary Acc.:</span> <%= lstm_bin_acc %>
                </p>
                <p class="card-text">
                  <span>Multi Acc.:</span> <%= lstm_mul_acc %>
                </p>
                <h5>Attack Type Counts:</h5>
                <ul class="attack-counts">
                  <% if (lstm_attack_counts &&
                  Object.keys(lstm_attack_counts).length > 0) { %> <%
                  Object.keys(lstm_attack_counts).forEach(function(type){ %>
                  <li><b><%= type %>:</b> <%= lstm_attack_counts[type] %></li>
                  <% }); %> <% } else { %>
                  <li></li>
                  <% } %>
                </ul>
                <a class="btn btn-primary btn-block" href="/lstm_bin_table"
                  >Binary-Class Table</a
                >
                <a class="btn btn-outline-primary btn-block" href="/lstm_table"
                  >Multi-Class Table</a
                >
              </div>
            </div>
          </div>
        </div>
        <!-- Action Buttons -->
        <div class="text-center mt-4">
          <a class="btn btn-primary mx-2" href="/submit"
            ><i class="fas fa-sync-alt mr-1"></i>Predict Again!</a
          >
          <a class="btn btn-danger mx-2" href="/logout"
            ><i class="fas fa-sign-out-alt mr-1"></i>Logout</a
          >
        </div>
      </div>
    </section>

    <!-- SCRIPTS -->
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
